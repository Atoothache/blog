(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{332:function(t,a,s){"use strict";s.r(a);var r=s(13),e=Object(r.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vmware虚拟机三种网络模式详解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vmware虚拟机三种网络模式详解"}},[t._v("#")]),t._v(" VMware虚拟机三种网络模式详解")]),t._v(" "),a("p",[t._v("vmware为我们提供了三种网络工作模式，它们分别是："),a("strong",[t._v("Bridged（桥接模式）")]),t._v("、"),a("strong",[t._v("NAT（网络地址转换模式）")]),t._v("、"),a("strong",[t._v("Host-Only（仅主机模式）")]),t._v("。")]),t._v(" "),a("p",[t._v("打开vmware虚拟机，我们可以在选项栏的“编辑”下的“虚拟网络编辑器”中看到VMnet0（桥接模式）、VMnet1（仅主机模式）、VMnet8（NAT模式），那么这些都是有什么作用呢？其实，我们现在看到的VMnet0表示的是用于桥接模式下的虚拟交换机；VMnet1表示的是用于仅主机模式下的虚拟交换机；VMnet8表示的是用于NAT模式下的虚拟交换机。")]),t._v(" "),a("p",[a("img",{attrs:{src:"E:%5CmdFile%5C20210301%5Cpic%5C%E8%99%9A%E6%8B%9F%E7%BD%91%E7%BB%9C%E7%BC%96%E8%BE%91%E5%99%A88.png",alt:""}})]),t._v(" "),a("p",[t._v("同时，在主机上对应的有VMware Network Adapter VMnet1和VMware Network Adapter VMnet8两块虚拟网卡，它们分别作用于仅主机模式与NAT模式下。在“网络连接”中我们可以看到这两块虚拟网卡，如果将这两块卸载了，可以在vmware的“编辑”下的“虚拟网络编辑器”中点击“还原默认设置”，可重新将虚拟网卡还原。")]),t._v(" "),a("p",[a("img",{attrs:{src:"E:%5CmdFile%5C20210301%5Cpic%5CVMnet1%E5%92%8CVMnet8%E4%B8%A4%E5%9D%97%E8%99%9A%E6%8B%9F%E7%BD%91%E5%8D%A1.png",alt:""}})]),t._v(" "),a("p",[t._v("小伙伴看到这里，肯定有疑问，为什么在真机上没有VMware Network Adapter VMnet0虚拟网卡呢？那么接下来，我们就一起来看一下这是为什么。")]),t._v(" "),a("h3",{attrs:{id:"一、bridged-桥接模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、bridged-桥接模式"}},[t._v("#")]),t._v(" 一、Bridged（桥接模式）")]),t._v(" "),a("p",[t._v("什么是桥接模式？桥接模式就是将主机网卡与虚拟机虚拟的网卡利用虚拟网桥进行通信。在桥接的作用下，类似于把物理主机虚拟为一个交换机，所有桥接设置的虚拟机连接到这个交换机的一个接口上，物理主机也同样插在这个交换机当中，所以所有桥接下的网卡与网卡都是交换模式的，相互可以访问而不干扰。在桥接模式下，虚拟机ip地址需要与主机在同一个网段，如果需要联网，则网关与DNS需要与主机网卡一致。其网络结构如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"E:%5CmdFile%5C20210301%5Cpic%5C%E6%A1%A5%E6%8E%A5%E6%A8%A1%E5%BC%8F.png",alt:""}})]),t._v(" "),a("p",[t._v("接下来，我们就来实际操作，如何设置桥接模式。")]),t._v(" "),a("p",[t._v("首先，安装完系统之后，在开启系统之前，点击“编辑虚拟机设置”来设置网卡模式。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204625484.png",alt:"设置网卡模式"}})]),t._v(" "),a("p",[t._v("点击“网络适配器”，选择“桥接模式”，然后“确定”")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204625485.png",alt:"网络适配器"}})]),t._v(" "),a("p",[t._v("在进入系统之前，我们先确认一下主机的ip地址、网关、DNS等信息。")]),t._v(" "),a("p",[a("img",{attrs:{src:"E:%5CmdFile%5C20210301%5Cpic%5C%E5%B1%80%E5%9F%9F%E7%BD%91IP%E4%BF%A1%E6%81%AF.png",alt:"主机信息"}})]),t._v(" "),a("p",[t._v("注意：如果是局域网也一定要给主机的网卡配置IP，子网掩码，网关缺一不可！！！不然会导致虚拟机获取不到IPV4，就算手动配置IPV4也无法ping通主机的网卡。")]),t._v(" "),a("p",[t._v("然后，进入系统编辑网卡配置文件，命令为vi /etc/sysconfig/network-scripts/ifcfg-eno16777736")]),t._v(" "),a("p",[t._v("ifcfg-eno16777736是我centos7的网卡配置，个人的可能有差异，打开自己的文件来配置。")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("HWADDR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("00:0C:29:80:93:8D\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("TYPE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("Ethernet\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("BOOTPROTO")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("static\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DEFROUTE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PEERDNS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("PEERROUTES")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV4_FAILURE_FATAL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("no\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV6INIT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV6_AUTOCONF")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV6_DEFROUTE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV6_PEERDNS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV6_PEERROUTES")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPV6_FAILURE_FATAL")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("no\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NAME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("eno16777736\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("f4df8183-350b-46f3-a30b-864eb81995a8\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("ONBOOT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("yes\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IPADDR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".90.234\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("NETMASK")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("255.255")]),t._v(".255.0\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("GATWAY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".90.1\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("DNS1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".90.1\n\n")])])]),a("p",[t._v("编辑完成，保存退出，然后重启虚拟机网卡")]),t._v(" "),a("div",{staticClass:"language-shell extra-class"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[t._v("./etc/init.d/network restart\n")])])]),a("p",[a("img",{attrs:{src:"E:%5CmdFile%5C20210301%5Cpic%5C%E9%87%8D%E5%90%AF%E7%BD%91%E5%8D%A1.png",alt:""}})]),t._v(" "),a("p",[t._v("使用ping命令ping局域网IP，测试能否联网。")]),t._v(" "),a("p",[a("img",{attrs:{src:"E:%5CmdFile%5C20210301%5Cpic%5C%E6%A1%A5%E6%8E%A5%E5%B1%80%E5%9F%9F%E7%BD%91ping%E9%80%9A.png",alt:""}})]),t._v(" "),a("h3",{attrs:{id:"二、nat-地址转换模式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#二、nat-地址转换模式"}},[t._v("#")]),t._v(" 二、NAT（地址转换模式）")]),t._v(" "),a("p",[t._v("刚刚我们说到，如果你的网络ip资源紧缺，但是你又希望你的虚拟机能够联网，这时候NAT模式是最好的选择。NAT模式借助虚拟NAT设备和虚拟DHCP服务器，使得虚拟机可以联网。其网络结构如下图所示：")]),t._v(" "),a("p",[a("img",{attrs:{src:"E:%5CmdFile%5C20210301%5Cpic%5Cnet%E6%A8%A1%E5%BC%8F.png",alt:""}})]),t._v(" "),a("p",[t._v("在NAT模式中，主机网卡直接与虚拟NAT设备相连，然后虚拟NAT设备与虚拟DHCP服务器一起连接在虚拟交换机VMnet8上，这样就实现了虚拟机联网。那么我们会觉得很奇怪，为什么需要虚拟网卡VMware Network Adapter VMnet8呢？原来我们的VMware Network Adapter VMnet8虚拟网卡主要是为了实现主机与虚拟机之间的通信。在之后的设置步骤中，我们可以加以验证。")]),t._v(" "),a("p",[t._v("首先，设置虚拟机中NAT模式的选项，打开vmware，点击“编辑”下的“虚拟网络编辑器”，设置NAT参数及DHCP参数。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204664452.png",alt:"虚拟网络编辑器"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204664453.png",alt:"NAT参数"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204664454.png",alt:"DHCP参数"}})]),t._v(" "),a("p",[t._v("将虚拟机的网络连接模式修改成NAT模式，点击“编辑虚拟机设置”。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204664455.png",alt:"编辑虚拟机设置"}})]),t._v(" "),a("p",[t._v("点击“网络适配器”，选择“NAT模式”")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204664456.png",alt:"NAT模式"}})]),t._v(" "),a("p",[t._v("然后开机启动系统，编辑网卡配置文件，命令为vi /etc/sysconfig/network-scripts/ifcfg-eth0")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204664457.png",alt:"编辑网卡配置文件"}})]),t._v(" "),a("p",[t._v("具体配置如下：")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204664458.png",alt:"具体配置"}})]),t._v(" "),a("p",[t._v("编辑完成，保存退出，然后重启虚拟机网卡，动态获取ip地址，使用ping命令ping外网ip，测试能否联网。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/160926204664459.png",alt:"测试能否联网"}})]),t._v(" "),a("p",[t._v("之前，我们说过VMware Network Adapter VMnet8虚拟网卡的作用，那我们现在就来测试一下。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/1609262046644510.png",alt:"虚拟网卡禁用"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/1609262046644511.png",alt:"是否能ping通"}})]),t._v(" "),a("p",[t._v("如此看来，虚拟机能联通外网，确实不是通过VMware Network Adapter VMnet8虚拟网卡，那么为什么要有这块虚拟网卡呢？")]),t._v(" "),a("p",[t._v("之前我们就说VMware Network Adapter VMnet8的作用是主机与虚拟机之间的通信，接下来，我们就用远程连接工具来测试一下。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://www.linuxidc.com/upload/2016_09/1609262046644512.png",alt:"远程连接工具测试"}})]),t._v(" "),a("p",[t._v("然后，将VMware Network Adapter VMnet8启用之后，发现远程工具可以连接上虚拟机了。")]),t._v(" "),a("p",[t._v("那么，这就是NAT模式，利用虚拟的NAT设备以及虚拟DHCP服务器来使虚拟机连接外网，而VMware Network Adapter VMnet8虚拟网卡是用来与虚拟机通信的。")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.linuxidc.com/Linux/2016-09/135521.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("桥接模式参考"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.linuxidc.com/Linux/2016-09/135521p2.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("net模式参考"),a("OutboundLink")],1)]),t._v(" "),a("h3",{attrs:{id:"三、双网卡配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#三、双网卡配置"}},[t._v("#")]),t._v(" 三、双网卡配置")]),t._v(" "),a("p",[t._v("1.虚拟机连接内网时，在虚拟机中使用1张网卡的情况下不能又使用局域网(内网)，又使用外部网络查找资料的情况。")]),t._v(" "),a("p",[t._v("解决方法：")]),t._v(" "),a("p",[t._v("1>虚拟机连接外网，添加第二个网络适配器")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200723195815298.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDEyMzQ1MQ==,size_16,color_FFFFFF,t_70",alt:"img"}})]),t._v(" "),a("p",[t._v("2> 配置虚拟机网络编辑器，使用使用第二张虚拟网卡桥接到本机外网网卡")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://img-blog.csdnimg.cn/20200723200122179.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MDEyMzQ1MQ==,size_16,color_FFFFFF,t_70",alt:"img"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"E:%5CmdFile%5C20210301%5Cpic%5C%E5%8F%8C%E7%BD%91%E5%8D%A1.png",alt:""}})]),t._v(" "),a("p",[a("a",{attrs:{href:"https://blog.csdn.net/weixin_40123451/article/details/107546395",target:"_blank",rel:"noopener noreferrer"}},[t._v("参考"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);